function [bx,by,bz] = Bcoil(n,x,y,z,I0,omega,t)
Dm = 1;

switch n
    case 1
        x1 = 0.55; y1 = -1.05;
        x2 = x1; y2 = -0.05;
        x3 = x1; z3 = 0.5;
        x4 = x1; z4 = -0.5;
        l1 = abs(z3-z4);
        l2 = l1;
        l3 = abs(y1-y2);
        l4 = l3;
        I = -I0*cos(omega*t);
        r1 = sqrt((x-x1)^2 + (y-y1)^2);
        b1 = Dm*I * ((l1/2+z)/(r1*sqrt(r1^2+(z+l1/2)^2)) + ...
                    (l1/2-z)/(r1*sqrt(r1^2+(z-l1/2)^2)));
        r2 = sqrt((x-x2)^2 + (y-y2)^2);
        b2 = Dm*I * ((l2/2+z)/(r2*sqrt(r2^2+(z+l2/2)^2)) + ...
                    (l2/2-z)/(r2*sqrt(r2^2+(z-l2/2)^2)));
        r3 = sqrt((x-x3)^2 + (z-z3)^2);
        b3 = Dm*I * ((l3/2-(y1+y2)/2+y)/(r3*sqrt(r3^2+(y-(y1+y2)/2+l3/2)^2)) + ...
                    (l3/2+(y1+y2)/2-y)/(r3*sqrt(r3^2+(y-(y1+y2)/2-l3/2)^2)));
        r4 = sqrt((x-x4)^2 + (z-z4)^2);
        b4 = Dm*I * ((l4/2-(y1+y2)/2+y)/(r4*sqrt(r4^2+(y-(y1+y2)/2+l4/2)^2)) + ...
                    (l4/2+(y1+y2)/2-y)/(r4*sqrt(r4^2+(y-(y1+y2)/2-l4/2)^2)));
        bz = b3*(-(x-x3))/r3 + b4*(x-x4)/r4;
        bx = b1*(-(y-y1)/r1) + b2*(y-y2)/r2 + b3*(z-z3)/r3 + b4*(-(z-z4))/r4; 
        by = b1*(x-x1)/r1 + b2*(-(x-x2)/r2);
        
    case 2
        x1 = 0.55; y1 = 0.05;
        x2 = x1; y2 = 1.05;
        x3 = x1; z3 = 0.5;
        x4 = x1; z4 = -0.5;
        l1 = abs(z3-z4);
        l2 = l1;
        l3 = abs(y1-y2);
        l4 = l3;
        I = I0*cos(omega*t);
        r1 = sqrt((x-x1)^2 + (y-y1)^2);
        b1 = Dm*I * ((l1/2+z)/(r1*sqrt(r1^2+(z+l1/2)^2)) + ...
                    (l1/2-z)/(r1*sqrt(r1^2+(z-l1/2)^2)));
        r2 = sqrt((x-x2)^2 + (y-y2)^2);
        b2 = Dm*I * ((l2/2+z)/(r2*sqrt(r2^2+(z+l2/2)^2)) + ...
                    (l2/2-z)/(r2*sqrt(r2^2+(z-l2/2)^2)));
        r3 = sqrt((x-x3)^2 + (z-z3)^2);
        b3 = Dm*I * ((l3/2-(y1+y2)/2+y)/(r3*sqrt(r3^2+(y-(y1+y2)/2+l3/2)^2)) + ...
                    (l3/2+(y1+y2)/2-y)/(r3*sqrt(r3^2+(y-(y1+y2)/2-l3/2)^2)));
        r4 = sqrt((x-x4)^2 + (z-z4)^2);
        b4 = Dm*I * ((l4/2-(y1+y2)/2+y)/(r4*sqrt(r4^2+(y-(y1+y2)/2+l4/2)^2)) + ...
                    (l4/2+(y1+y2)/2-y)/(r4*sqrt(r4^2+(y-(y1+y2)/2-l4/2)^2)));
        bz = b3*(-(x-x3))/r3 + b4*(x-x4)/r4;
        bx = b1*(-(y-y1)/r1) + b2*(y-y2)/r2 + b3*(z-z3)/r3 + b4*(-(z-z4))/r4; 
        by = b1*(x-x1)/r1 + b2*(-(x-x2)/r2);
        
    case 3
        x1 = -0.55; y1 = 0.05;
        x2 = x1; y2 = 1.05;
        x3 = x1; z3 = 0.5;
        x4 = x1; z4 = -0.5;
        l1 = abs(z3-z4);
        l2 = l1;
        l3 = abs(y1-y2);
        l4 = l3;
        I = I0*cos(omega*t);
        r1 = sqrt((x-x1)^2 + (y-y1)^2);
        b1 = Dm*I * ((l1/2+z)/(r1*sqrt(r1^2+(z+l1/2)^2)) + ...
                    (l1/2-z)/(r1*sqrt(r1^2+(z-l1/2)^2)));
        r2 = sqrt((x-x2)^2 + (y-y2)^2);
        b2 = Dm*I * ((l2/2+z)/(r2*sqrt(r2^2+(z+l2/2)^2)) + ...
                    (l2/2-z)/(r2*sqrt(r2^2+(z-l2/2)^2)));
        r3 = sqrt((x-x3)^2 + (z-z3)^2);
        b3 = Dm*I * ((l3/2-(y1+y2)/2+y)/(r3*sqrt(r3^2+(y-(y1+y2)/2+l3/2)^2)) + ...
                    (l3/2+(y1+y2)/2-y)/(r3*sqrt(r3^2+(y-(y1+y2)/2-l3/2)^2)));
        r4 = sqrt((x-x4)^2 + (z-z4)^2);
        b4 = Dm*I * ((l4/2-(y1+y2)/2+y)/(r4*sqrt(r4^2+(y-(y1+y2)/2+l4/2)^2)) + ...
                    (l4/2+(y1+y2)/2-y)/(r4*sqrt(r4^2+(y-(y1+y2)/2-l4/2)^2)));
        bz = b3*(-(x-x3))/r3 + b4*(x-x4)/r4;
        bx = b1*(-(y-y1)/r1) + b2*(y-y2)/r2 + b3*(z-z3)/r3 + b4*(-(z-z4))/r4; 
        by = b1*(x-x1)/r1 + b2*(-(x-x2)/r2);
        
    case 4
        x1 = -0.55; y1 = -1.05;
        x2 = x1; y2 = -0.05;
        x3 = x1; z3 = 0.5;
        x4 = x1; z4 = -0.5;
        l1 = abs(z3-z4);
        l2 = l1;
        l3 = abs(y1-y2);
        l4 = l3;
        I = -I0*cos(omega*t);
        r1 = sqrt((x-x1)^2 + (y-y1)^2);
        b1 = Dm*I * ((l1/2+z)/(r1*sqrt(r1^2+(z+l1/2)^2)) + ...
                    (l1/2-z)/(r1*sqrt(r1^2+(z-l1/2)^2)));
        r2 = sqrt((x-x2)^2 + (y-y2)^2);
        b2 = Dm*I * ((l2/2+z)/(r2*sqrt(r2^2+(z+l2/2)^2)) + ...
                    (l2/2-z)/(r2*sqrt(r2^2+(z-l2/2)^2)));
        r3 = sqrt((x-x3)^2 + (z-z3)^2);
        b3 = Dm*I * ((l3/2-(y1+y2)/2+y)/(r3*sqrt(r3^2+(y-(y1+y2)/2+l3/2)^2)) + ...
                    (l3/2+(y1+y2)/2-y)/(r3*sqrt(r3^2+(y-(y1+y2)/2-l3/2)^2)));
        r4 = sqrt((x-x4)^2 + (z-z4)^2);
        b4 = Dm*I * ((l4/2-(y1+y2)/2+y)/(r4*sqrt(r4^2+(y-(y1+y2)/2+l4/2)^2)) + ...
                    (l4/2+(y1+y2)/2-y)/(r4*sqrt(r4^2+(y-(y1+y2)/2-l4/2)^2)));
        bz = b3*(-(x-x3))/r3 + b4*(x-x4)/r4;
        bx = b1*(-(y-y1)/r1) + b2*(y-y2)/r2 + b3*(z-z3)/r3 + b4*(-(z-z4))/r4; 
        by = b1*(x-x1)/r1 + b2*(-(x-x2)/r2);
        
    case 5
        y1 = -1.05; z1 = 0.55;
        y2 = -0.05; z2 = z1;
        x3 = 0.5; z3 = z1;
        x4 = -0.5; z4 = z1;
        l1 = abs(x3-x4);
        l2 = l1;
        l3 = abs(y1-y2);
        l4 = l3;
        I = I0*sin(omega*t);
        r1 = sqrt((y-y1)^2 + (z-z1)^2);
        b1 = Dm*I* ((l1/2+x)/(r1*sqrt(r1^2+(x+l1/2)^2)) + ...
                  (l1/2-x)/(r1*sqrt(r1^2+(x-l1/2)^2)));
        r2 = sqrt((y-y2)^2 + (z-z2)^2);
        b2 = Dm*I* ((l2/2+x)/(r2*sqrt(r2^2+(x+l2/2)^2)) + ...
                  (l2/2-x)/(r2*sqrt(r2^2+(x-l2/2)^2)));
        r3 = sqrt((x-x3)^2 + (z-z3)^2);
        b3 = Dm*I * ((l3/2-(y1+y2)/2+y)/(r3*sqrt(r3^2+(y-(y1+y2)/2+l3/2)^2)) + ...
                    (l3/2+(y1+y2)/2-y)/(r3*sqrt(r3^2+(y-(y1+y2)/2-l3/2)^2)));
        r4 = sqrt((x-x4)^2 + (z-z4)^2);
        b4 = Dm*I * ((l4/2-(y1+y2)/2+y)/(r4*sqrt(r4^2+(y-(y1+y2)/2+l4/2)^2)) + ...
                    (l4/2+(y1+y2)/2-y)/(r4*sqrt(r4^2+(y-(y1+y2)/2-l4/2)^2)));        
        bx = b3*(z-z3)/r3 + b4*(-(z-z4))/r4;
        by = b1*(-(z-z1)/r1) + b2*(z-z2)/r2; 
        bz = b1*(y-y1)/r1 + b2*(-(y-y2)/r2) + b3*(-(x-x3))/r3 + b4*(x-x4)/r4;
        
    case 6
        y1 = 0.05; z1 = 0.55;
        y2 = 1.05; z2 = z1;
        x3 = 0.5; z3 = z1;
        x4 = -0.5; z4 = z1;
        l1 = abs(x3-x4);
        l2 = l1;
        l3 = abs(y1-y2);
        l4 = l3;
        I = -I0*sin(omega*t);
        r1 = sqrt((y-y1)^2 + (z-z1)^2);
        b1 = Dm*I* ((l1/2+x)/(r1*sqrt(r1^2+(x+l1/2)^2)) + ...
                  (l1/2-x)/(r1*sqrt(r1^2+(x-l1/2)^2)));
        r2 = sqrt((y-y2)^2 + (z-z2)^2);
        b2 = Dm*I* ((l2/2+x)/(r2*sqrt(r2^2+(x+l2/2)^2)) + ...
                  (l2/2-x)/(r2*sqrt(r2^2+(x-l2/2)^2)));
        r3 = sqrt((x-x3)^2 + (z-z3)^2);
        b3 = Dm*I * ((l3/2-(y1+y2)/2+y)/(r3*sqrt(r3^2+(y-(y1+y2)/2+l3/2)^2)) + ...
                    (l3/2+(y1+y2)/2-y)/(r3*sqrt(r3^2+(y-(y1+y2)/2-l3/2)^2)));
        r4 = sqrt((x-x4)^2 + (z-z4)^2);
        b4 = Dm*I * ((l4/2-(y1+y2)/2+y)/(r4*sqrt(r4^2+(y-(y1+y2)/2+l4/2)^2)) + ...
                    (l4/2+(y1+y2)/2-y)/(r4*sqrt(r4^2+(y-(y1+y2)/2-l4/2)^2)));        
        bx = b3*(z-z3)/r3 + b4*(-(z-z4))/r4;
        by = b1*(-(z-z1)/r1) + b2*(z-z2)/r2; 
        bz = b1*(y-y1)/r1 + b2*(-(y-y2)/r2) + b3*(-(x-x3))/r3 + b4*(x-x4)/r4;
        
    case 7
        y1 = 0.05; z1 = -0.55;
        y2 = 1.05; z2 = z1;
        x3 = 0.5; z3 = z1;
        x4 = -0.5; z4 = z1;
        l1 = abs(x3-x4);
        l2 = l1;
        l3 = abs(y1-y2);
        l4 = l3;
        I = -I0*sin(omega*t);
        r1 = sqrt((y-y1)^2 + (z-z1)^2);
        b1 = Dm*I* ((l1/2+x)/(r1*sqrt(r1^2+(x+l1/2)^2)) + ...
                  (l1/2-x)/(r1*sqrt(r1^2+(x-l1/2)^2)));
        r2 = sqrt((y-y2)^2 + (z-z2)^2);
        b2 = Dm*I* ((l2/2+x)/(r2*sqrt(r2^2+(x+l2/2)^2)) + ...
                  (l2/2-x)/(r2*sqrt(r2^2+(x-l2/2)^2)));
        r3 = sqrt((x-x3)^2 + (z-z3)^2);
        b3 = Dm*I * ((l3/2-(y1+y2)/2+y)/(r3*sqrt(r3^2+(y-(y1+y2)/2+l3/2)^2)) + ...
                    (l3/2+(y1+y2)/2-y)/(r3*sqrt(r3^2+(y-(y1+y2)/2-l3/2)^2)));
        r4 = sqrt((x-x4)^2 + (z-z4)^2);
        b4 = Dm*I * ((l4/2-(y1+y2)/2+y)/(r4*sqrt(r4^2+(y-(y1+y2)/2+l4/2)^2)) + ...
                    (l4/2+(y1+y2)/2-y)/(r4*sqrt(r4^2+(y-(y1+y2)/2-l4/2)^2)));        
        bx = b3*(z-z3)/r3 + b4*(-(z-z4))/r4;
        by = b1*(-(z-z1)/r1) + b2*(z-z2)/r2; 
        bz = b1*(y-y1)/r1 + b2*(-(y-y2)/r2) + b3*(-(x-x3))/r3 + b4*(x-x4)/r4;
        
    case 8
        y1 = -1.05; z1 = -0.55;
        y2 = -0.05; z2 = z1;
        x3 = 0.5; z3 = z1;
        x4 = -0.5; z4 = z1;
        l1 = abs(x3-x4);
        l2 = l1;
        l3 = abs(y1-y2);
        l4 = l3;
        I = I0*sin(omega*t);
        r1 = sqrt((y-y1)^2 + (z-z1)^2);
        b1 = Dm*I* ((l1/2+x)/(r1*sqrt(r1^2+(x+l1/2)^2)) + ...
                  (l1/2-x)/(r1*sqrt(r1^2+(x-l1/2)^2)));
        r2 = sqrt((y-y2)^2 + (z-z2)^2);
        b2 = Dm*I* ((l2/2+x)/(r2*sqrt(r2^2+(x+l2/2)^2)) + ...
                  (l2/2-x)/(r2*sqrt(r2^2+(x-l2/2)^2)));
        r3 = sqrt((x-x3)^2 + (z-z3)^2);
        b3 = Dm*I * ((l3/2-(y1+y2)/2+y)/(r3*sqrt(r3^2+(y-(y1+y2)/2+l3/2)^2)) + ...
                    (l3/2+(y1+y2)/2-y)/(r3*sqrt(r3^2+(y-(y1+y2)/2-l3/2)^2)));
        r4 = sqrt((x-x4)^2 + (z-z4)^2);
        b4 = Dm*I * ((l4/2-(y1+y2)/2+y)/(r4*sqrt(r4^2+(y-(y1+y2)/2+l4/2)^2)) + ...
                    (l4/2+(y1+y2)/2-y)/(r4*sqrt(r4^2+(y-(y1+y2)/2-l4/2)^2)));        
        bx = b3*(z-z3)/r3 + b4*(-(z-z4))/r4;
        by = b1*(-(z-z1)/r1) + b2*(z-z2)/r2; 
        bz = b1*(y-y1)/r1 + b2*(-(y-y2)/r2) + b3*(-(x-x3))/r3 + b4*(x-x4)/r4;
end
    
end

