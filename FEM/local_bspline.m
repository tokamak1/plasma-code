c = [0, 0, 0, 1; ...
    1, 3, 3, -3; ...
    4, 0, -6, 3; ...
    1, -3, 3, -1];

c_center1 = c * diag(1/6 * [1,1/h1,1/h1^2,1/h1^3]);
c_center2 = c * diag(1/6 * [1,1/h2,1/h2^2,1/h2^3]);

cl1 = [1,-3,3,-1];

c_bl1 = cl1 * diag([1,1/h1,1/h1^2,1/h1^3]);

cl2 = [0, 12, -18, 7; ...
    1, -3, 3, -1];

c_bl2 = cl2 * diag(1/4 * [1,1/h1,1/h1^2,1/h1^3]);

cl13 = [0, 0, 18, -11; ...
    7, 3, -15, 7; ...
    2, -6, 6, -2];

c_bl3 = cl13 * diag(1/12 * [1,1/h1,1/h1^2,1/h1^3]);

cr1 = [0, 0, 0, 2; ... 
    2, 6, 6, -7; ... 
    7, -3, -15, 11];

c_br1 = cr1 * diag(1/12*[1,1/h2,1/h2^2,1/h2^3]);
    
cr2 = [0, 0, 0, 1; ... 
    1, 3, 3, -7];

c_br2 = cr2 * diag(1/4*[1,1/h2,1/h2^2,1/h2^3]);

cr3 = [0, 0, 0, 1];

c_br3 = cr3 * diag([1,1/h2,1/h2^2,1/h2^3]);

c1 = [0, 0, 0, 1/h1^3; ...
    1, 3/h1, 3/h1^2, -1/h1/h2/(2*h1+h2)*(7*h2/h1+2*h2^2/h1^2); ...
    (7*h1+5*h2)/(2*h1+h2), -3/(2*h1+h2)*(1-h2/h1), ...
    -3/h1/(2*h1+h2)*(5+h2/h1), ...
    1/h1/(h1+h2)/(2*h1+h2)*(11+6*h2/h1+h2^2/h1^2); ...
    6*h2^2/(2*h1+h2)/(h1+h2), -18*h2/(2*h1+h2)/(h1+h2), ...
    18/(2*h1+h2)/(h1+h2), -6/h2/(2*h1+h2)/(h1+h2)];

hc1 = (3*h1 + h2)/4;

a1 = hc1/(c1(1,:)*phi(-1,h1) + ...
        c1(2,:)*phi(-1,h1) + ...
        c1(3,:)*phi(-1,h1) + ...
        c1(4,:)*phi(-1,h2));


c_x1 = a1 * c1; 

c2 = [0, 0, 0, 1/h1^3; ...
    1, 3/h1, 3/h1^2, -1/h1/(h1+h2)/(h1+2*h2)*(7+9*h2/h1+2*h2^2/h1^2); ...
    12*h2/(h1+2*h2),-12*(h1-h2)/h1/(h1+2*h2), -18/h1/(h1+2*h2), ...
    1/h1/(h1+h2)/(h1+2*h2)*(7+9*h1/h2+2*h1^2/h2^2); ...
    h2/h1*(2*h1+h2)/(h1+2*h2), -3/h1*(2*h1+h2)/(h1+2*h2), ...
    3/h2/h1*(2*h1+h2)/(h1+2*h2), -1/h2^2/h1*(2*h1+h2)/(h1+2*h2)];

hc2 = (2*h1 + 2*h2)/4;

a2 = hc2/(c2(1,:)*phi(-1,h1) + ...
        c2(2,:)*phi(-1,h1) + ...
        c2(3,:)*phi(-1,h2) + ...
        c2(4,:)*phi(-1,h2));
c_x2 = a2 * c2;

c3 = [0, 0, 0, 1/h1^3; ...
    1, 3/h1, 3/h1^2, -1/6/h2^3*(1+6*h2/h1+11*h2^2/h1^2); ...
    1/6*(5+12*h2/h1+7*h2^2/h1^2), -1/2/h2*(1-h2^2/h1^2), ...
    -1/2/h2^2*(1+6*h2/h1+5*h2^2/h1^2), 1/6/h2^3*(2+9*h2/h1+7*h2^2/h1^2); ...
    1/6*(1+3*h2/h1+2*h2^2/h1^2), -1/2/h2*(1+3*h2/h1+2*h2^2/h1^2), ...
    1/2/h2^2*(1+3*h2/h1+2*h2^2/h1^2), -1/6/h2^3*(1+3*h2/h1+2*h2^2/h1^2)];

hc3 = (h1 + 3*h2)/4;

a3 = hc3/(c3(1,:)*phi(-1,h1) + ...
        c3(2,:)*phi(-1,h2) + ...
        c3(3,:)*phi(-1,h2) + ...
        c3(4,:)*phi(-1,h2));

c_x3 = a3 * c3;






    
