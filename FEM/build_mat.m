Iv2 = zeros(nh+3);
Ivp2 = zeros(nh+3);

for i = 4 : nh
    Iv2(i,i) = y2(hs(i-2),[C(1:4,i),C(1:4,i)]) - ...
           y2(hs(i-3),[C(1:4,i),C(1:4,i)]) + ...
           y2(hs(i-1),[C(5:8,i),C(5:8,i)]) - ...
           y2(hs(i-2),[C(5:8,i),C(5:8,i)]) + ...
           y2(hs(i),[C(9:12,i),C(9:12,i)]) - ...
           y2(hs(i-1),[C(9:12,i),C(9:12,i)]) + ...
           y2(hs(i+1),[C(13:16,i),C(13:16,i)]) - ...
           y2(hs(i),[C(13:16,i),C(13:16,i)]);
    Ivp2(i,i) = yp2(hs(i-2),[C(1:4,i),C(1:4,i)]) - ...
           yp2(hs(i-3),[C(1:4,i),C(1:4,i)]) + ...
           yp2(hs(i-1),[C(5:8,i),C(5:8,i)]) - ...
           yp2(hs(i-2),[C(5:8,i),C(5:8,i)]) + ...
           yp2(hs(i),[C(9:12,i),C(9:12,i)]) - ...
           yp2(hs(i-1),[C(9:12,i),C(9:12,i)]) + ...
           yp2(hs(i+1),[C(13:16,i),C(13:16,i)]) - ...
           yp2(hs(i),[C(13:16,i),C(13:16,i)]);
       
    Iv2(i,i+1) = y2(hs(i-1),[C(5:8,i),C(1:4,i+1)]) - ...
           y2(hs(i-2),[C(5:8,i),C(1:4,i+1)]) + ...
           y2(hs(i),[C(9:12,i),C(5:8,i+1)]) - ...
           y2(hs(i-1),[C(9:12,i),C(5:8,i+1)]) + ...
           y2(hs(i+1),[C(13:16,i),C(9:12,i+1)]) - ...
           y2(hs(i),[C(13:16,i),C(9:12,i+1)]);
    Ivp2(i,i+1) = yp2(hs(i-1),[C(5:8,i),C(1:4,i+1)]) - ...
           yp2(hs(i-2),[C(5:8,i),C(1:4,i+1)]) + ...
           yp2(hs(i),[C(9:12,i),C(5:8,i+1)]) - ...
           yp2(hs(i-1),[C(9:12,i),C(5:8,i+1)]) + ...
           yp2(hs(i+1),[C(13:16,i),C(9:12,i+1)]) - ...
           yp2(hs(i),[C(13:16,i),C(9:12,i+1)]); 
    Iv2(i+1,i) = Iv2(i,i+1);
    Ivp2(i+1,i) = Ivp2(i,i+1);
    
    Iv2(i,i+2) = y2(hs(i),[C(9:12,i),C(1:4,i+2)]) - ...
           y2(hs(i-1),[C(9:12,i),C(1:4,i+2)]) + ...
           y2(hs(i+1),[C(13:16,i),C(5:8,i+2)]) - ...
           y2(hs(i),[C(13:16,i),C(5:8,i+2)]);
    Ivp2(i,i+2) = yp2(hs(i),[C(9:12,i),C(1:4,i+2)]) - ...
           yp2(hs(i-1),[C(9:12,i),C(1:4,i+2)]) + ...
           yp2(hs(i+1),[C(13:16,i),C(5:8,i+2)]) - ...
           yp2(hs(i),[C(13:16,i),C(5:8,i+2)]); 
    Iv2(i+2,i) = Iv2(i,i+2);
    Ivp2(i+2,i) = Ivp2(i,i+2);
    
    Iv2(i,i+3) = y2(hs(i+1),[C(13:16,i),C(1:4,i+3)]) - ...
           y2(hs(i),[C(13:16,i),C(1:4,i+3)]);
    Ivp2(i,i+3) = yp2(hs(i+1),[C(13:16,i),C(1:4,i+3)]) - ...
           yp2(hs(i),[C(13:16,i),C(1:4,i+3)]); 
    Iv2(i+3,i) = Iv2(i,i+3);
    Ivp2(i+3,i) = Ivp2(i,i+3);
       
end
Iv2(1,1) = y2(hs(2),[C(1:4,1),C(1:4,1)]);       
Ivp2(1,1) = yp2(hs(2),[C(1:4,1),C(1:4,1)]);         
Iv2(1,2) = y2(hs(2),[C(1:4,1),C(1:4,2)]);       
Ivp2(1,2) = yp2(hs(2),[C(1:4,1),C(1:4,2)]);
Iv2(2,1) = Iv2(1,2);
Ivp2(2,1) = Ivp2(1,2);
Iv2(1,3) = y2(hs(2),[C(1:4,1),C(1:4,3)]);       
Ivp2(1,3) = yp2(hs(2),[C(1:4,1),C(1:4,3)]);
Iv2(3,1) = Iv2(1,3);
Ivp2(3,1) = Ivp2(1,3);
Iv2(1,4) = y2(hs(2),[C(1:4,1),C(1:4,4)]);       
Ivp2(1,4) = yp2(hs(2),[C(1:4,1),C(1:4,4)]);
Iv2(4,1) = Iv2(1,4);
Ivp2(4,1) = Ivp2(1,4);

Iv2(2,2) = y2(hs(2),[C(1:4,2),C(1:4,2)]) + ...
    y2(hs(3),[C(5:8,2),C(5:8,2)]) - ...
    y2(hs(2),[C(5:8,2),C(5:8,2)]);       
Ivp2(2,2) = yp2(hs(2),[C(1:4,2),C(1:4,2)]) + ...
    yp2(hs(3),[C(5:8,2),C(5:8,2)]) - ...
    yp2(hs(2),[C(5:8,2),C(5:8,2)]);         
Iv2(2,3) = y2(hs(2),[C(1:4,2),C(1:4,3)])+ ...
    y2(hs(3),[C(5:8,2),C(5:8,3)]) - ...
    y2(hs(2),[C(5:8,2),C(5:8,3)]);       
Ivp2(2,3) = yp2(hs(2),[C(1:4,2),C(1:4,3)])+ ...
    yp2(hs(3),[C(5:8,2),C(5:8,3)]) - ...
    yp2(hs(2),[C(5:8,2),C(5:8,3)]);
Iv2(3,2) = Iv2(2,3);
Ivp2(3,2) = Ivp2(2,3);
Iv2(2,4) = y2(hs(2),[C(1:4,2),C(1:4,4)])+ ...
    y2(hs(3),[C(5:8,2),C(5:8,4)]) - ...
    y2(hs(2),[C(5:8,2),C(5:8,4)]);       
Ivp2(2,4) = yp2(hs(2),[C(1:4,2),C(1:4,4)])+ ...
    yp2(hs(3),[C(5:8,2),C(5:8,4)]) - ...
    yp2(hs(2),[C(5:8,2),C(5:8,4)]);
Iv2(4,2) = Iv2(2,4);
Ivp2(4,2) = Ivp2(2,4);
Iv2(2,5) = y2(hs(3),[C(5:8,2),C(1:4,5)]) - ...
    y2(hs(2),[C(5:8,2),C(1:4,5)]);       
Ivp2(2,5) = yp2(hs(3),[C(5:8,2),C(1:4,5)]) - ...
    yp2(hs(2),[C(5:8,2),C(1:4,5)]);
Iv2(5,2) = Iv2(2,5);
Ivp2(5,2) = Ivp2(2,5);

Iv2(3,3) = y2(hs(2),[C(1:4,3),C(1:4,3)]) + ...
    y2(hs(3),[C(5:8,3),C(5:8,3)]) - ...
    y2(hs(2),[C(5:8,3),C(5:8,3)]) + ...
    y2(hs(4),[C(9:12,3),C(9:12,3)]) - ...
    y2(hs(3),[C(9:12,3),C(9:12,3)]);       
Ivp2(3,3) = yp2(hs(2),[C(1:4,3),C(1:4,3)]) + ...
    yp2(hs(3),[C(5:8,3),C(5:8,3)]) - ...
    yp2(hs(2),[C(5:8,3),C(5:8,3)]) + ...
    yp2(hs(4),[C(9:12,3),C(9:12,3)]) - ...
    yp2(hs(3),[C(9:12,3),C(9:12,3)]);         
Iv2(3,4) = y2(hs(2),[C(1:4,3),C(1:4,4)]) + ...
    y2(hs(3),[C(5:8,3),C(5:8,4)]) - ...
    y2(hs(2),[C(5:8,3),C(5:8,4)]) + ...
    y2(hs(4),[C(9:12,3),C(9:12,4)]) - ...
    y2(hs(3),[C(9:12,3),C(9:12,4)]);       
Ivp2(3,4) = yp2(hs(2),[C(1:4,3),C(1:4,4)]) + ...
    yp2(hs(3),[C(5:8,3),C(5:8,4)]) - ...
    yp2(hs(2),[C(5:8,3),C(5:8,4)]) + ...
    yp2(hs(4),[C(9:12,3),C(9:12,4)]) - ...
    yp2(hs(3),[C(9:12,3),C(9:12,4)]);
Iv2(4,3) = Iv2(3,4);
Ivp2(4,3) = Ivp2(3,4);
Iv2(3,5) = y2(hs(3),[C(5:8,3),C(1:4,5)]) - ...
    y2(hs(2),[C(5:8,3),C(1:4,5)]) + ...
    y2(hs(4),[C(9:12,3),C(5:8,5)]) - ...
    y2(hs(3),[C(9:12,3),C(5:8,5)]);       
Ivp2(3,5) = yp2(hs(3),[C(5:8,3),C(1:4,5)]) - ...
    yp2(hs(2),[C(5:8,3),C(1:4,5)]) + ...
    yp2(hs(4),[C(9:12,3),C(5:8,5)]) - ...
    yp2(hs(3),[C(9:12,3),C(5:8,5)]);
Iv2(5,3) = Iv2(3,5);
Ivp2(5,3) = Ivp2(3,5);
Iv2(3,6) = y2(hs(4),[C(9:12,3),C(1:4,6)]) - ...
    y2(hs(3),[C(9:12,3),C(1:4,6)]);       
Ivp2(3,6) = yp2(hs(4),[C(9:12,3),C(1:4,6)]) - ...
    yp2(hs(3),[C(9:12,3),C(1:4,6)]);
Iv2(6,3) = Iv2(3,6);
Ivp2(6,3) = Ivp2(3,6);


Iv2(nh+1,nh+1) = y2(hs(nh-1),[C(1:4,nh+1),C(1:4,nh+1)]) - ...
    y2(hs(nh-2),[C(1:4,nh+1),C(1:4,nh+1)]) + ...
    y2(hs(nh),[C(5:8,nh+1),C(5:8,nh+1)]) - ...
    y2(hs(nh-1),[C(5:8,nh+1),C(5:8,nh+1)]) + ...
    y2(hs(nh+1),[C(9:12,nh+1),C(9:12,nh+1)]) - ...
    y2(hs(nh),[C(9:12,nh+1),C(9:12,nh+1)]);       
Ivp2(nh+1,nh+1) = yp2(hs(nh-1),[C(1:4,nh+1),C(1:4,nh+1)]) - ...
    yp2(hs(nh-2),[C(1:4,nh+1),C(1:4,nh+1)]) + ...
    yp2(hs(nh),[C(5:8,nh+1),C(5:8,nh+1)]) - ...
    yp2(hs(nh-1),[C(5:8,nh+1),C(5:8,nh+1)]) + ...
    yp2(hs(nh+1),[C(9:12,nh+1),C(9:12,nh+1)]) - ...
    yp2(hs(nh),[C(9:12,nh+1),C(9:12,nh+1)]);          
Iv2(nh+1,nh+2) = y2(hs(nh),[C(5:8,nh+1),C(1:4,nh+2)]) - ...
    y2(hs(nh-1),[C(5:8,nh+1),C(1:4,nh+2)]) + ...
    y2(hs(nh+1),[C(9:12,nh+1),C(5:8,nh+2)]) - ...
    y2(hs(nh),[C(9:12,nh+1),C(5:8,nh+2)]);       
Ivp2(nh+1,nh+2) = yp2(hs(nh),[C(5:8,nh+1),C(1:4,nh+2)]) - ...
    yp2(hs(nh-1),[C(5:8,nh+1),C(1:4,nh+2)]) + ...
    yp2(hs(nh+1),[C(9:12,nh+1),C(5:8,nh+2)]) - ...
    yp2(hs(nh),[C(9:12,nh+1),C(5:8,nh+2)]);
Iv2(nh+2,nh+1) = Iv2(nh+1,nh+2);
Ivp2(nh+2,nh+1) = Ivp2(nh+1,nh+2);
Iv2(nh+1,nh+3) = y2(hs(nh+1),[C(9:12,nh+1),C(1:4,nh+3)]) - ...
    y2(hs(nh),[C(9:12,nh+1),C(1:4,nh+3)]);       
Ivp2(nh+1,nh+3) = yp2(hs(nh+1),[C(9:12,nh+1),C(1:4,nh+3)]) - ...
    yp2(hs(nh),[C(9:12,nh+1),C(1:4,nh+3)]);
Iv2(nh+3,nh+1) = Iv2(nh+1,nh+3);
Ivp2(nh+3,nh+1) = Ivp2(nh+1,nh+3);

Iv2(nh+2,nh+2) = y2(hs(nh),[C(1:4,nh+2),C(1:4,nh+2)]) - ...
    y2(hs(nh-1),[C(1:4,nh+2),C(1:4,nh+2)]) + ...
    y2(hs(nh+1),[C(5:8,nh+2),C(5:8,nh+2)]) - ...
    y2(hs(nh),[C(5:8,nh+2),C(5:8,nh+2)]);       
Ivp2(nh+2,nh+2) = yp2(hs(nh),[C(1:4,nh+2),C(1:4,nh+2)]) - ...
    yp2(hs(nh-1),[C(1:4,nh+2),C(1:4,nh+2)]) + ...
    yp2(hs(nh+1),[C(5:8,nh+2),C(5:8,nh+2)]) - ...
    yp2(hs(nh),[C(5:8,nh+2),C(5:8,nh+2)]);
Iv2(nh+2,nh+3) = y2(hs(nh+1),[C(5:8,nh+2),C(1:4,nh+3)]) - ...
    y2(hs(nh),[C(5:8,nh+2),C(1:4,nh+3)]);       
Ivp2(nh+2,nh+3) = yp2(hs(nh+1),[C(5:8,nh+2),C(1:4,nh+3)]) - ...
    yp2(hs(nh),[C(5:8,nh+2),C(1:4,nh+3)]);
Iv2(nh+3,nh+2) = Iv2(nh+2,nh+3);
Ivp2(nh+3,nh+2) = Ivp2(nh+2,nh+3);

Iv2(nh+3,nh+3) = y2(hs(nh+1),[C(1:4,nh+3),C(1:4,nh+3)]) - ...
    y2(hs(nh),[C(1:4,nh+3),C(1:4,nh+3)]);
Ivp2(nh+3,nh+3) = yp2(hs(nh+1),[C(1:4,nh+3),C(1:4,nh+3)]) - ...
    yp2(hs(nh),[C(1:4,nh+3),C(1:4,nh+3)]);

